{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Kosmic Lab K-Codex v2.0 (Mycelix Epistemic Charter Compliant)",
  "description": "Immutable experimental record with Epistemic Charter v2.0 classification. Ensures complete reproducibility and integrates with Mycelix Decentralized Knowledge Graph.",
  "version": "2.0.0",
  "type": "object",
  "required": [
    "run_id",
    "commit",
    "config_hash",
    "seed",
    "experiment",
    "params",
    "estimators",
    "metrics",
    "timestamp",
    "epistemic_tier_e",
    "epistemic_tier_n",
    "epistemic_tier_m",
    "verifiability"
  ],
  "properties": {
    "run_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique UUIDv4 identifier for this experimental run"
    },
    "commit": {
      "type": "string",
      "description": "Git SHA of exact code version used for reproducibility"
    },
    "config_hash": {
      "type": "string",
      "pattern": "^([a-f0-9]{64})?$",
      "description": "SHA256 hash of configuration parameters (or empty string if no config provided)"
    },
    "seed": {
      "type": "integer",
      "description": "Random number generator seed for deterministic execution"
    },
    "experiment": {
      "type": "string",
      "description": "Experiment type identifier (e.g., 'fre_phase1', 'track_b_sac', 'track_c_rescue_v3')"
    },
    "universe": {
      "type": "string",
      "description": "Universe identifier for multi-universe simulations"
    },
    "params": {
      "type": "object",
      "description": "All hyperparameters used in the experiment"
    },
    "estimators": {
      "type": "object",
      "description": "Exact algorithms and parameters used for metric computation",
      "properties": {
        "phi": {
          "type": "string",
          "description": "Integrated information (Î¦) estimation method"
        },
        "te": {
          "type": "object",
          "description": "Transfer entropy estimation parameters",
          "properties": {
            "estimator": {"type": "string"},
            "k": {"type": "integer"},
            "lag": {"type": "integer"}
          },
          "required": ["estimator", "k", "lag"]
        }
      },
      "required": ["phi", "te"]
    },
    "metrics": {
      "type": "object",
      "description": "Output measurements from the experiment",
      "properties": {
        "K": {
          "type": "number",
          "description": "Kosmic Signature Index (coherence measure)"
        },
        "TAT": {"type": "number"},
        "Recovery": {"type": "number"},
        "AUC_K": {"type": "number"},
        "TE_macro_micro": {"type": "number"},
        "TE_symmetry": {"type": "number"}
      },
      "required": ["K"]
    },
    "ci": {
      "type": "object",
      "description": "Confidence intervals for key metrics",
      "properties": {
        "K_low": {"type": "number"},
        "K_high": {"type": "number"}
      }
    },
    "environment": {
      "type": "object",
      "description": "Runtime environment details (OS, hardware, libraries)"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 UTC timestamp of experiment execution"
    },
    "researcher_agent": {
      "type": "string",
      "description": "Mycelix DID or AgentPubKey (added when published to DHT)",
      "pattern": "^(did:mycelix:|uhCAk)"
    },
    "epistemic_tier_e": {
      "type": "string",
      "enum": ["E0", "E1", "E2", "E3", "E4"],
      "default": "E4",
      "description": "E-Axis: Empirical verifiability tier. E4 = Publicly Reproducible (highest standard). See Mycelix Epistemic Charter v2.0 Appendix A."
    },
    "epistemic_tier_n": {
      "type": "string",
      "enum": ["N0", "N1", "N2", "N3"],
      "default": "N1",
      "description": "N-Axis: Normative authority tier. N1 = Communal Consensus (research community). See Mycelix Epistemic Charter v2.0 Appendix A."
    },
    "epistemic_tier_m": {
      "type": "string",
      "enum": ["M0", "M1", "M2", "M3"],
      "default": "M3",
      "description": "M-Axis: Materiality/permanence tier. M3 = Foundational (eternal preservation on DHT). See Mycelix Epistemic Charter v2.0 Appendix A."
    },
    "verifiability": {
      "type": "object",
      "description": "Metadata on how to verify the claim's empirical tier",
      "required": ["method", "status"],
      "properties": {
        "method": {
          "type": "string",
          "enum": ["None", "Signature", "ZKProof", "AuditGuildReview", "PublicCode"],
          "default": "PublicCode",
          "description": "Verification method. PublicCode = open source code + open data + checksums."
        },
        "status": {
          "type": "string",
          "enum": ["Unverified", "Verified", "Pending", "Disputed", "ResolvedDisputeInvalidated", "Superseded"],
          "default": "Verified",
          "description": "Current verification status of the claim"
        },
        "proof_cid": {
          "type": "string",
          "description": "IPFS Content ID (CID) for reproducibility package or ZK proof data"
        }
      }
    },
    "related_claims": {
      "type": "array",
      "description": "Knowledge graph relationships to other K-Codices (enables scientific evolution tracking)",
      "items": {
        "type": "object",
        "required": ["relationship_type", "related_claim_id"],
        "properties": {
          "relationship_type": {
            "type": "string",
            "enum": [
              "SUPPORTS",
              "REFUTES",
              "CLARIFIES",
              "CONTEXTUALIZES",
              "SUPERCEDES",
              "REFERENCES",
              "AUTHENTICATES"
            ],
            "description": "Type of relationship to the related claim"
          },
          "related_claim_id": {
            "type": "string",
            "format": "uuid",
            "description": "run_id of the related K-Codex"
          },
          "context": {
            "type": "string",
            "description": "Optional explanation of the relationship (e.g., 'Attractor-based mechanism replaces perturbation approach')"
          }
        }
      }
    }
  }
}
