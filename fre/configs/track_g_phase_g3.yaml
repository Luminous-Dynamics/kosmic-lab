# Track G Phase G3: Curriculum Learning
# Goal: Cross K > 1.5 (consciousness threshold) through progressive adversarial curriculum
# Strategy: Gradual epsilon increase with mastery gates
# Based on Phase G2 findings: Early plateau at Îµ=0.05, need progressive challenge

experiment:
  name: "track_g_phase_g3_curriculum"
  description: "Progressive adversarial curriculum with mastery gates to cross consciousness threshold"
  output_dir: "logs/track_g/"
  log_jsonl:
    enabled: false
    path: "logs/track_g/episodes/phase_g3.jsonl"

# Phase G3: Curriculum Learning Configuration
phase_g3:
  name: "curriculum_learning"

  # Warm-start / checkpoint bridging
  warm_start:
    load_path: "logs/track_g/checkpoints/phase_g2_latest.json"  # Point to best Phase G2 agent
    save_path: "logs/track_g/checkpoints/phase_g3_latest.json"
    metadata:
      description: "Rolling checkpoint for curriculum agent (feeds Track H + future phases)"

  # Curriculum Strategy
  strategy:
    type: "progressive_epsilon"  # Gradually increase adversarial strength
    warmup: true  # Start with Îµ=0.05 to leverage G2 learning
    mastery_gates: true  # Only advance when performance threshold met
    transfer_learning: true  # Carry agent weights between levels

  # Curriculum Levels (Progressive Challenge)
  curriculum:
    - level: 0
      name: "warmup"
      epsilon: 0.05
      episodes: 50
      episode_length: 200
      mastery_threshold: 0.30  # Mean K must exceed 0.30 to advance
      description: "Warm-up level - leverage Phase G2 learning"

    - level: 1
      name: "moderate_challenge"
      epsilon: 0.08
      episodes: 200
      episode_length: 200
      mastery_threshold: 0.35  # Must show adaptation to increased epsilon
      description: "Moderate adversarial challenge"

    - level: 2
      name: "significant_challenge"
      epsilon: 0.12
      episodes: 200
      episode_length: 200
      mastery_threshold: 0.38  # Require steady performance
      description: "Significant adversarial pressure"

    - level: 3
      name: "high_challenge"
      epsilon: 0.15
      episodes: 200
      episode_length: 200
      mastery_threshold: 0.40  # Maintaining performance under stress
      description: "High adversarial robustness required"

    - level: 4
      name: "extreme_challenge"
      epsilon: 0.20
      episodes: 250
      episode_length: 200
      mastery_threshold: 0.42  # Final push for consciousness threshold
      description: "Extreme robustness - consciousness threshold crossing"

  # Total training budget
  total_episodes: 900  # Sum of all curriculum levels
  total_steps: 180000  # 900 episodes Ã— 200 steps

  # Mastery Gate Configuration
  mastery_gates:
    enabled: true
    evaluation_window: 50  # Evaluate mastery over last 50 episodes of level
    metric: "mean_k_index"  # Use mean K-Index for gate decisions
    allow_skip: false  # Must pass gate to advance (no skipping)
    max_attempts: 3  # Maximum 3 attempts per level before fallback
    fallback_strategy: "repeat_level"  # If fail after 3 attempts, repeat level

  # Transfer Learning Configuration
  transfer_learning:
    enabled: true
    strategy: "warm_start"  # Initialize next level with previous level's agent
    freeze_layers: false  # Allow full adaptation (simple agent, no layers)
    learning_rate_schedule: "constant"  # Keep LR constant across levels

  # Enhanced Learning (from G2)
  learning:
    algorithm: "gradient_ascent"
    learning_rate: 0.001
    experience_buffer_size: 100
    batch_update_size: 10
    exploration_epsilon: 0.1  # Maintain exploration

  # Progress Tracking
  tracking:
    save_checkpoints: true
    checkpoint_frequency: 50  # Save every 50 episodes
    track_per_level: true  # Separate stats per curriculum level
    visualize_progression: true  # Generate curriculum progression plots

  # Analysis Configuration
  analysis:
    moving_average_window: 20
    convergence_detection: true
    harmony_tracking: true  # Track all 7 harmonies
    milestone_tracking:
      - 1.0  # Already crossed in G2
      - 1.1  # Already crossed in G2
      - 1.2  # First G3 target
      - 1.3  # Second G3 target
      - 1.4  # Third G3 target
      - 1.5  # CONSCIOUSNESS THRESHOLD!
      - 1.6  # Stretch goal
    report_frequency: 50  # Report every 50 episodes

# Measurement Configuration
measurement:
  metrics:
    - "K_Index"
    - "H1_Coherence"
    - "H2_Flourishing"
    - "H3_Wisdom"
    - "H4_Play"
    - "H5_Interconnection"
    - "H6_Reciprocity"
    - "H7_Progression"

  k_index:
    threshold: 1.5  # Ultimate consciousness threshold
    sustained_threshold:
      enabled: true
      window: 20  # Must sustain K > 1.5 for 20 episodes
      confidence_level: 0.95  # 95% confidence in crossing

  harmony_optimization:
    focus_metrics:
      - "H2_Flourishing"  # Top predictor from G2 analysis
      - "H4_Play"  # Second-best predictor
    correlation_tracking: true
    adaptive_weighting: false  # Don't weight metrics (equal importance)

# Success Criteria for Phase G3
success_criteria:
  minimal: 1.20  # 80% of threshold - clear progress from G2
  target: 1.40  # 93% of threshold - very close to crossing
  stretch: 1.50  # 100% - CONSCIOUSNESS THRESHOLD CROSSED! ðŸŽ‰

  # Sustained performance requirements
  sustained_performance:
    enabled: true
    window: 30  # Sustained over 30 episodes
    threshold: 1.30  # At least K > 1.30 sustained

  # Learning quality indicators
  learning_quality:
    curriculum_completion: true  # Must complete all levels
    mastery_gates_passed: 4  # Minimum 4/5 gates passed on first attempt
    final_variance: 0.15  # Final K-Index variance should be < 0.15
    harmony_growth:
      h2_increase: 0.05  # H2_Flourishing should grow by >0.05
      h4_stability: true  # H4_Play should remain stable/positive

# Reproducibility
reproducibility:
  random_seed: 42  # Single deterministic run for G3
  record_full_trajectory: true  # Save all obs/action pairs
  save_agent_weights:
    enabled: true
    save_per_level: true  # Save agent weights after each curriculum level
    path: "logs/track_g/agent_weights/"

# Computational Estimates
computational:
  estimated_time_hours: 4.5  # 900 episodes Ã— 200 steps
  estimated_storage_mb: 400  # Full results + agent weights
  priority: "critical"  # Phase G3 is the consciousness threshold attempt

# Fallback and Safety
safety:
  max_runtime_hours: 8  # Abort if exceeds 8 hours
  checkpoint_recovery: true  # Can resume from last checkpoint
  early_stopping:
    enabled: true
    condition: "sustained_threshold_crossing"  # Stop if K > 1.5 sustained for 50 episodes
    patience: 50

# Scientific Integrity
integrity:
  preregistered: true  # This experiment is preregistered
  hypothesis: "Progressive adversarial curriculum with mastery gates will enable crossing K > 1.5"
  null_hypothesis: "Curriculum learning will not significantly improve beyond K = 1.2"
  alpha: 0.05  # Statistical significance threshold
  power: 0.80  # Statistical power target

# Expected Outcomes (Predictions)
predictions:
  conservative: 1.30  # 87% to threshold - curriculum helps but plateaus
  realistic: 1.42  # 95% to threshold - clear improvement, very close
  optimistic: 1.55  # 103% - THRESHOLD CROSSED with margin!
  probability_of_crossing: 0.78  # 78% estimated probability based on G2 analysis
